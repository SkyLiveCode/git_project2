<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Calculate 1</title>
  <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>
  <h1>Real-time Calculation 1</h1>
  
  <form id="calcForm1">
    <!-- ช่องใส่ข้อมูลการคำนวณ 1 และ 2 -->
    <input type="text" id="calinput1" name="calinput1" placeholder="Calculation Input 1" />
    <input type="text" id="calinput2" name="calinput2" placeholder="Calculation Input 2" /><br>
    <!-- ช่องใส่ข้อมูลการคำนวณ 3 และ 4 -->
    <input type="text" id="calinput3" name="calinput3" placeholder="Calculation Input 3" />
    <input type="text" id="calinput4" name="calinput4" placeholder="Calculation Input 4" /><br>
    <!-- ช่องใส่ข้อมูลเพิ่มเติม 1 และ 2 -->
    <input type="text" id="infoinput1" name="infoinput1" placeholder="Info Input 1" />
    <input type="text" id="infoinput2" name="infoinput2" placeholder="Info Input 2" /><br>
    <!-- ช่องใส่ข้อมูลเพิ่มเติม 3 และ 4 -->
    <input type="text" id="infoinput3" name="infoinput3" placeholder="Info Input 3" />
    <input type="text" id="infoinput4" name="infoinput4" placeholder="Info Input 4" /><br>
    
    <!-- ช่องใส่ลายเซ็นต์ 1 และปุ่มกรอกลายเซ็นต์ -->
    <input type="text" id="signature1" name="signature1" placeholder="Signature 1" />
    <button type="button" id="fillSignature1">Fill Signature 1</button><br>
    <!-- ช่องใส่ลายเซ็นต์ 2 และปุ่มกรอกลายเซ็นต์ -->
    <input type="text" id="signature2" name="signature2" placeholder="Signature 2" />
    <button type="button" id="fillSignature2">Fill Signature 2"></button><br>
    <!-- ช่องใส่ลายเซ็นต์ 3 และปุ่มกรอกลายเซ็นต์ -->
    <input type="text" id="signature3" name="signature3" placeholder="Signature 3" />
    <button type="button" id="fillSignature3">Fill Signature 3"></button><br>
    
    <!-- ช่องใส่ข้อความ 1 และ 2 -->
    <textarea id="textarea1" name="textarea1" placeholder="Textarea 1"></textarea><br>
    <textarea id="textarea2" name="textarea2" placeholder="Textarea 2"></textarea><br>
    
    <!-- ปุ่มเลือกแบบตัวเลือกสำหรับ Form1 -->
    <input type="radio" name="radio1" value="option1" id="radio1Option1">Option 1
    <input type="radio" name="radio1" value="option2" id="radio1Option2">Option 2
    <input type="radio" name="radio1" value="option3" id="radio1Option3">Option 3<br>
    
    <!-- ปุ่มเลือกแบบตัวเลือกสำหรับ Form2 -->
    <input type="radio" name="radio2" value="option1" id="radio2Option1">Option 1
    <input type="radio" name="radio2" value="option2" id="radio2Option2">Option 2
    <input type="radio" name="radio2" value="option3" id="radio2Option3">Option 3<br>
    
    <button type="submit">Submit</button>
  </form>

  <h1>Sum Result: <span id="sumResult"></span></h1>
  <h1>Difference Result: <span id="differenceResult"></span></h1>
  <h1>Signature 1 Status: <span id="signatureStatus1"></span></h1>
  <h1>Signature 2 Status: <span id="signatureStatus2"></span></h1>
  <h1>Signature 3 Status: <span id="signatureStatus3"></span></h1>

  <!-- รูปภาพที่จะถูกแสดงตามเงื่อนไข -->
  <img id="signatureImage" src="path_to_your_image.jpg" style="display:none;" />

  <form action="/logout" method="POST">
    <button type="submit">Logout</button>
  </form>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/assets/js/cal1.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      function getInputs() {
        const inputs = {};
        document.querySelectorAll('#calcForm1 input, #calcForm1 textarea').forEach(input => {
          if (input.type === 'radio') {
            if (input.checked) {
              inputs[input.name] = input.value;
            }
          } else {
            inputs[input.name] = input.value;
          }
        });
        return inputs;
      }

      function sendInputs(inputs) {
        const socket = io();
        socket.emit('calculate', inputs);
        socket.on('calculatedResult', (data) => {
          document.getElementById('sumResult').textContent = data.sumResult;
          document.getElementById('differenceResult').textContent = data.differenceResult;
          document.getElementById('signatureStatus1').textContent = data.signatureStatus1;
          document.getElementById('signatureStatus2').textContent = data.signatureStatus2;
          document.getElementById('signatureStatus3').textContent = data.signatureStatus3;

          // แสดง/ซ่อนรูปภาพตามลายเซ็นต์ 3
          const signature3 = document.getElementById('signature3').value;
          if (signature3.toLowerCase() === 'sky') {
            document.getElementById('signatureImage').style.display = 'block';
          } else {
            document.getElementById('signatureImage').style.display = 'none';
          }

          // ตั้งค่าปุ่มเลือกแบบตัวเลือก
          document.getElementById('radio1Option1').checked = data.radio1 === 'option1';
          document.getElementById('radio1Option2').checked = data.radio1 === 'option2';
          document.getElementById('radio1Option3').checked = data.radio1 === 'option3';
          document.getElementById('radio2Option1').checked = data.radio2 === 'option1';
          document.getElementById('radio2Option2').checked = data.radio2 === 'option2';
          document.getElementById('radio2Option3').checked = data.radio2 === 'option3';
          document.getElementById('infoinput1').value = data.infoinput1 || '';
          document.getElementById('infoinput2').value = data.infoinput2 || '';
          document.getElementById('infoinput3').value = data.infoinput3 || '';
          document.getElementById('infoinput4').value = data.infoinput4 || '';
        });
      }

      fetch('/get-inputs')
        .then(response => response.json())
        .then(data => {
          if (data.inputs) {
            Object.keys(data.inputs).forEach(key => {
              if (document.getElementById(key)) {
                document.getElementById(key).value = data.inputs[key] || '';
              }
            });

            // ตั้งค่าปุ่มเลือกแบบตัวเลือกตามข้อมูลที่ได้รับ
            if (data.inputs.radio1) {
              document.querySelector(`input[name="radio1"][value="${data.inputs.radio1}"]`).checked = true;
            }
            if (data.inputs.radio2) {
              document.querySelector(`input[name="radio2"][value="${data.inputs.radio2}"]`).checked = true;
            }

            sendInputs(data.inputs);
          }
        });

      document.getElementById('fillSignature1').addEventListener('click', function() {
        document.getElementById('signature1').value = 'สมหมาย';
        sendInputs(getInputs());
      });

      document.getElementById('fillSignature2').addEventListener('click', function() {
        document.getElementById('signature2').value = 'สมหมาย';
        sendInputs(getInputs());
      });

      document.getElementById('fillSignature3').addEventListener('click', function() {
        document.getElementById('signature3').value = 'สมหมาย';
        sendInputs(getInputs());
      });

      document.getElementById('calcForm1').addEventListener('submit', function(event) {
        event.preventDefault();
        const inputs = getInputs();

        fetch('/update-inputs', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ inputs: inputs }),
        }).then(response => response.json())
          .then(data => {
            if (data.success) {
              alert('Inputs updated successfully');
              sendInputs(inputs);
            }
          });
      });

      // เพิ่มการตรวจสอบแบบเรียลไทม์สำหรับ signature3
      document.getElementById('signature3').addEventListener('input', function() {
        const signature3 = document.getElementById('signature3').value;
        if (signature3.toLowerCase() === 'sky') {
          document.getElementById('signatureImage').style.display = 'block';
        } else {
          document.getElementById('signatureImage').style.display = 'none';
        }
      });
    });
  </script>
</body>
</html>
